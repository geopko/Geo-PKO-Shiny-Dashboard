runApp()
View(TCCmapData)
View(TCCmapData)
library(dplyr)
library(tidyr)
library(stringr)
library(countrycode)
library(readr)
library(readxl)
library(lubridate)
#### file for mapmaker ####
geopko <- read_xlsx("Geo_PKO_v.2.0.xlsx", col_types = c("text"))
map_df <- geopko %>%
mutate_at(vars(c(no.troops, no.tcc, longitude, latitude,
unmo.dummy, unmo.dummy)), as.numeric) %>%
mutate(hq=as.factor(hq))
#appending ISO code to the dataset
ISO_df <- codelist %>% select(cown, iso3c) %>% mutate_all(as.character)
map_df <- left_join(map_df, ISO_df, by=c("cow_code"="cown"))
map_df <- map_df %>%
mutate(iso3c = case_when(country == "Ethiopia/Eritrea" ~ "ETH, ERI",
country == "Kosovo" ~ "XKO",
mission == "UNFICYP" ~ "CYP, XNC",
country == "Mauritania" ~ "MRT",
country == "Western Sahara" ~ "ESH",
TRUE ~ as.character(iso3c)),
Month = as.numeric(month),
MonthName = as.character(lubridate::month(Month, label = TRUE, abbr = FALSE))) %>%
unite(joined_date, c("year","MonthName"), sep=": ", remove=FALSE) %>%
unite(timepoint, c("year","MonthName"), sep=" ", remove=FALSE)
write_excel_csv(map_df, "Geo_PKO_v2.0_ISO3.csv")
runApp()
.libPaths()
runApp()
shiny::runApp()
runApp()
map_df %>% filter(mission=="MINURSO") -> test
test %>%  tibble::rowid_to_column("ID") %>%
select(ID, location, No.troops, No.TCC, RPF:UAV, Other.Type, -RPF_No,
-Inf_No, -FPU_No, -RES_No, -FP_No) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
filter(binary==1) %>%
mutate(trooptypes=case_when(trooptypes == "Other.Type" ~ "Others",
trooptypes == "SF" ~ "Special Forces",
trooptypes == "Inf" ~ "Infantry",
TRUE ~ as.character(trooptypes))) %>%
group_by(ID, location, No.troops, No.TCC) %>%
summarize(Troop.Compo = str_c(trooptypes, collapse=", ")) %>% ungroup() %>%
mutate(No.TCC=ifelse(is.na(No.TCC), "Unknown", No.TCC)) %>%
select(-ID) -> testtable
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
filter(binary==1) %>%
mutate(trooptypes=case_when(trooptypes == "sf" ~ "Special Forces",
trooptypes == "inf" ~ "Infantry",
trooptypes == "he.sup" ~ "Helicopter Support",
trooptypes == "avia" ~ "Aviation",
trooptypes == "mp" ~ "Military Police",
trooptypes == "uav" ~ "Unmanned Aerial Vehicles",
trooptypes == "recon" ~ "Reconnaissance",
trooptypes == "maint" ~ "Maintenance",
trooptypes == "med" ~ "Medical",
trooptypes == "eng" ~ "Engineer",
trooptypes == "fpu" ~ "Formed Police Unit",
trooptypes == "fp" ~ "Force Protection",
trooptypes == "riv" ~ "Riverine",
trooptypes == "sig" ~ "Signal",
trooptypes == "trans" ~ "Transport",
trooptypes == "other.type" ~ "Others",
trooptypes == "eng" ~ "Engineer",
TRUE ~ as.character(trooptypes))) %>%
group_by(ID, location, no.troops, no.tcc) %>%
summarize(Troop.Compo = str_c(trooptypes, collapse=", ")) %>% ungroup() %>%
mutate(no.tcc=ifelse(is.na(no.tcc), "Unknown", no.tcc)) %>%
select(-ID)
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
filter(binary==1) %>%
mutate(trooptypes=case_when(trooptypes == "sf" ~ "Special Forces",
trooptypes == "inf" ~ "Infantry",
trooptypes == "he.sup" ~ "Helicopter Support",
trooptypes == "avia" ~ "Aviation",
trooptypes == "mp" ~ "Military Police",
trooptypes == "uav" ~ "Unmanned Aerial Vehicles",
trooptypes == "recon" ~ "Reconnaissance",
trooptypes == "maint" ~ "Maintenance",
trooptypes == "med" ~ "Medical",
trooptypes == "eng" ~ "Engineer",
trooptypes == "fpu" ~ "Formed Police Unit",
trooptypes == "fp" ~ "Force Protection",
trooptypes == "riv" ~ "Riverine",
trooptypes == "sig" ~ "Signal",
trooptypes == "trans" ~ "Transport",
trooptypes == "other.type" ~ "Others",
trooptypes == "eng" ~ "Engineer",
TRUE ~ as.character(trooptypes)))
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary")
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
filter(binary==1) %>%
pull(binary) %>% levels()
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
filter(binary==1) %>%
pull(binary) %>% factor()
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary")
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>% distinct(binary)
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
#  filter(binary==1) %>%
mutate(trooptypes=case_when(trooptypes == "sf" ~ "Special Forces",
trooptypes == "inf" ~ "Infantry",
trooptypes == "he.sup" ~ "Helicopter Support",
trooptypes == "avia" ~ "Aviation",
trooptypes == "mp" ~ "Military Police",
trooptypes == "uav" ~ "Unmanned Aerial Vehicles",
trooptypes == "recon" ~ "Reconnaissance",
trooptypes == "maint" ~ "Maintenance",
trooptypes == "med" ~ "Medical",
trooptypes == "eng" ~ "Engineer",
trooptypes == "fpu" ~ "Formed Police Unit",
trooptypes == "fp" ~ "Force Protection",
trooptypes == "riv" ~ "Riverine",
trooptypes == "sig" ~ "Signal",
trooptypes == "trans" ~ "Transport",
trooptypes == "other.type" ~ "Others",
trooptypes == "eng" ~ "Engineer",
TRUE ~ as.character(trooptypes))) %>%
group_by(ID, location, no.troops, no.tcc) %>%
summarize(Troop.Compo = str_c(trooptypes, collapse=", ")) %>% ungroup() %>%
mutate(no.tcc=ifelse(is.na(no.tcc), "Unknown", no.tcc)) %>%
select(-ID)
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
#filter(binary==1) %>%
# mutate(trooptypes=case_when(trooptypes == "sf" ~ "Special Forces",
#                             trooptypes == "inf" ~ "Infantry",
#                             trooptypes == "he.sup" ~ "Helicopter Support",
#                             trooptypes == "avia" ~ "Aviation",
#                             trooptypes == "mp" ~ "Military Police",
#                             trooptypes == "uav" ~ "Unmanned Aerial Vehicles",
#                             trooptypes == "recon" ~ "Reconnaissance",
#                             trooptypes == "maint" ~ "Maintenance",
#                             trooptypes == "med" ~ "Medical",
#                             trooptypes == "eng" ~ "Engineer",
#                             trooptypes == "fpu" ~ "Formed Police Unit",
#                             trooptypes == "fp" ~ "Force Protection",
#                             trooptypes == "riv" ~ "Riverine",
#                             trooptypes == "sig" ~ "Signal",
#                             trooptypes == "trans" ~ "Transport",
#                             trooptypes == "other.type" ~ "Others",
#                             trooptypes == "eng" ~ "Engineer",
#                             TRUE ~ as.character(trooptypes))) %>%
group_by(ID, location, no.troops, no.tcc) %>%
summarize(Troop.Compo = str_c(trooptypes, collapse=", ")) %>% ungroup() %>%
mutate(no.tcc=ifelse(is.na(no.tcc), "Unknown", no.tcc)) %>%
select(-ID)
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary")
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID) %>%
mutate(dc = sum(binary, na.rm=TRUE))
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID) %>%
mutate(dc = sum(as.numeric(binary), na.rm=TRUE))
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc) %>%
summarise(dc = sum(as.numeric(binary), na.rm=TRUE))
View(test)
View(test)
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc) %>%
summarise(dc = sum(as.numeric(binary), na.rm=TRUE)) %>% distinct(dc)
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc) %>%
summarise(dc = sum(as.numeric(binary), na.rm=TRUE)) %>% pull(dc) %>% distinct()
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc) %>%
summarise(dc = sum(as.numeric(binary), na.rm=TRUE)) %>% pull(dc)
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc) %>%
summarise(dc = sum(as.numeric(binary), na.rm=TRUE))
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc) %>%
summarise(dc = sum(as.numeric(binary), na.rm=TRUE)) -> test3
View(test3)
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc, trooptypes) %>%
summarise(dc = sum(as.numeric(binary), na.rm=TRUE)) %>%
mutate(trooptypes=case_when(trooptypes == "sf" ~ "Special Forces",
trooptypes == "inf" ~ "Infantry",
trooptypes == "he.sup" ~ "Helicopter Support",
trooptypes == "avia" ~ "Aviation",
trooptypes == "mp" ~ "Military Police",
trooptypes == "uav" ~ "Unmanned Aerial Vehicles",
trooptypes == "recon" ~ "Reconnaissance",
trooptypes == "maint" ~ "Maintenance",
trooptypes == "med" ~ "Medical",
trooptypes == "eng" ~ "Engineer",
trooptypes == "fpu" ~ "Formed Police Unit",
trooptypes == "fp" ~ "Force Protection",
trooptypes == "riv" ~ "Riverine",
trooptypes == "sig" ~ "Signal",
trooptypes == "trans" ~ "Transport",
trooptypes == "other.type" ~ "Others",
trooptypes == "eng" ~ "Engineer",
TRUE ~ as.character(trooptypes))) %>%
group_by(ID, location, no.troops, no.tcc) %>%
summarize(Troop.Compo = str_c(trooptypes, collapse=", ")) %>% ungroup() %>%
mutate(no.tcc=ifelse(is.na(no.tcc), "Unknown", no.tcc)) %>%
select(-ID)
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc, trooptypes) %>%
summarise(dc = sum(as.numeric(binary), na.rm=TRUE)) %>%
mutate(trooptypes=case_when(trooptypes == "sf" ~ "Special Forces",
trooptypes == "inf" ~ "Infantry",
trooptypes == "he.sup" ~ "Helicopter Support",
trooptypes == "avia" ~ "Aviation",
trooptypes == "mp" ~ "Military Police",
trooptypes == "uav" ~ "Unmanned Aerial Vehicles",
trooptypes == "recon" ~ "Reconnaissance",
trooptypes == "maint" ~ "Maintenance",
trooptypes == "med" ~ "Medical",
trooptypes == "eng" ~ "Engineer",
trooptypes == "fpu" ~ "Formed Police Unit",
trooptypes == "fp" ~ "Force Protection",
trooptypes == "riv" ~ "Riverine",
trooptypes == "sig" ~ "Signal",
trooptypes == "trans" ~ "Transport",
trooptypes == "other.type" ~ "Others",
trooptypes == "eng" ~ "Engineer",
TRUE ~ as.character(trooptypes)))
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc, trooptypes) %>%
summarise(dc = sum(as.numeric(binary), na.rm=TRUE)) %>%
mutate(trooptypes=case_when(trooptypes == "sf" ~ "Special Forces",
trooptypes == "inf" ~ "Infantry",
trooptypes == "he.sup" ~ "Helicopter Support",
trooptypes == "avia" ~ "Aviation",
trooptypes == "mp" ~ "Military Police",
trooptypes == "uav" ~ "Unmanned Aerial Vehicles",
trooptypes == "recon" ~ "Reconnaissance",
trooptypes == "maint" ~ "Maintenance",
trooptypes == "med" ~ "Medical",
trooptypes == "eng" ~ "Engineer",
trooptypes == "fpu" ~ "Formed Police Unit",
trooptypes == "fp" ~ "Force Protection",
trooptypes == "riv" ~ "Riverine",
trooptypes == "sig" ~ "Signal",
trooptypes == "trans" ~ "Transport",
trooptypes == "other.type" ~ "Others",
trooptypes == "eng" ~ "Engineer",
TRUE ~ as.character(trooptypes))) -> test3
View(test3)
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc, trooptypes) %>%
summarise(dc = sum(as.numeric(binary), na.rm=TRUE)) %>%
mutate(trooptypes=case_when(trooptypes == "sf" ~ "Special Forces",
trooptypes == "inf" ~ "Infantry",
trooptypes == "he.sup" ~ "Helicopter Support",
trooptypes == "avia" ~ "Aviation",
trooptypes == "mp" ~ "Military Police",
trooptypes == "uav" ~ "Unmanned Aerial Vehicles",
trooptypes == "recon" ~ "Reconnaissance",
trooptypes == "maint" ~ "Maintenance",
trooptypes == "med" ~ "Medical",
trooptypes == "eng" ~ "Engineer",
trooptypes == "fpu" ~ "Formed Police Unit",
trooptypes == "fp" ~ "Force Protection",
trooptypes == "riv" ~ "Riverine",
trooptypes == "sig" ~ "Signal",
trooptypes == "trans" ~ "Transport",
trooptypes == "other.type" ~ "Others",
trooptypes == "eng" ~ "Engineer",
TRUE ~ as.character(trooptypes)))
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc, trooptypes) %>%
mutate(dc = sum(as.numeric(binary), na.rm=TRUE)) %>%
mutate(trooptypes=case_when(trooptypes == "sf" ~ "Special Forces",
trooptypes == "inf" ~ "Infantry",
trooptypes == "he.sup" ~ "Helicopter Support",
trooptypes == "avia" ~ "Aviation",
trooptypes == "mp" ~ "Military Police",
trooptypes == "uav" ~ "Unmanned Aerial Vehicles",
trooptypes == "recon" ~ "Reconnaissance",
trooptypes == "maint" ~ "Maintenance",
trooptypes == "med" ~ "Medical",
trooptypes == "eng" ~ "Engineer",
trooptypes == "fpu" ~ "Formed Police Unit",
trooptypes == "fp" ~ "Force Protection",
trooptypes == "riv" ~ "Riverine",
trooptypes == "sig" ~ "Signal",
trooptypes == "trans" ~ "Transport",
trooptypes == "other.type" ~ "Others",
trooptypes == "eng" ~ "Engineer",
TRUE ~ as.character(trooptypes)))
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc, trooptypes) %>%
mutate(dc = sum(as.numeric(binary), na.rm=TRUE))
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc, trooptypes) %>%
mutate(dc = sum(as.numeric(binary), na.rm=TRUE))  %>% ungroup() %>%
group_by(ID, location, no.troops, no.tcc) %>%
summarize(troop.compo = case_when(
dc > 0 ~ str_c(trooptypes, collapse=", "),
TRUE ~ "Data on troop types not available for this location"
))
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc, trooptypes) %>%
mutate(dc = sum(as.numeric(binary), na.rm=TRUE))  %>% ungroup() %>%
group_by(ID, location, no.troops, no.tcc) %>%
summarize(troop.compo = case_when(
dc > 0 ~ str_c(trooptypes, collapse=", "),
TRUE ~ "Data on troop types not available for this location" %>% ungroup()
))
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc, trooptypes) %>%
mutate(dc = sum(as.numeric(binary), na.rm=TRUE))  %>% ungroup() %>%
group_by(ID, location, no.troops, no.tcc) %>%
summarize(troop.compo = case_when(
dc > 0 ~ str_c(trooptypes, collapse=", "),
TRUE ~ "Data on troop types not available for this location"
))
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc, trooptypes) %>%
mutate(dc = sum(as.numeric(binary), na.rm=TRUE))  %>% ungroup() %>%
group_by(ID, location, no.troops, no.tcc) %>%
summarize(troop.compo = case_when(
dc > 0 ~ str_c(trooptypes, collapse=", "),
TRUE ~ "Data on troop types not available for this location"
)) -> test4
View(test4)
View(test4)
test %>% tibble::rowid_to_column("ID") %>%
select(ID, location, no.troops, no.tcc, rpf:uav, other.type, -rpf.no,
-inf.no, -fpu.no, -res.no, -fp.no) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(5:23, names_to="trooptypes", values_to="binary") %>%
group_by(ID, location, no.troops, no.tcc, trooptypes) %>%
mutate(dc = sum(as.numeric(binary), na.rm=TRUE))  %>%
group_by(ID, location, no.troops, no.tcc) %>%
summarize(troop.compo = case_when(
dc > 0 ~ str_c(trooptypes, collapse=", "),
TRUE ~ "Data on troop types not available for this location"
)) -> test4
View(test4)
runApp()
map_df %>% filter(Mission=="BINUB") -> test
map_df %>% filter(mission=="BINUB") -> test
View(test)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
library(readxl)
library(readr)
geopko2 <- readxl::read_xlsx("Geo_PKO_v2.0.xlsx", col_types="text")
geopko2 <- readxl::read_xlsx("Geo_PKO_v.2.0.xlsx", col_types="text")
View(geopko2)
write_excel_csv(geopko2, "Geo_PKO_v.2.0.csv")
geopko3 <- readr::read_csv("Geo_PKO_v.2.0.csv")
View(geopko3)
shiny::runApp()
runApp()
rsconnect::setAccountInfo(name='geopko', token='C0C48F10F5F800AC83349FF38E5CBF0F', secret='F9Cu9DARdAGevbUw50M3lUOGLUqzapDsYZwkA2De')
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
library(rsconnect)
deployApp(account="geopko")
runApp()
deployApp(account="geopko")
runApp()
deployApp(account="geopko")
deployApp(account="geopko")
runApp()
install.packages("shinyjs")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
