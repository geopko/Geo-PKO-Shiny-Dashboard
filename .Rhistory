Longitude=as.numeric(Longitude),
Latitude=as.numeric(Latitude),
UNMO.dummy=as.numeric(UNMO.dummy),
UNPOL.dummy=as.numeric(UNPOL.dummy),
HQ=as.factor(HQ))
tcc_df <- geopko %>% select(Source, Mission, Year, Month, No.troops, 52:85) %>%
group_by(Source, Mission, Year, Month) %>%
mutate(Total.troops=sum(No.troops, na.rm=T)) %>% ungroup()
Years <- geopko
Years <- Years %>% group_by(Mission, Location)%>% summarize(start_date=min(Year), end_date=max(Year))
View(Years)
sfdf2 <- Years %>% filter(Mission=="UNOCI")
lolli <-   ggplot(sfdf2) +
geom_segment(aes(x=start_date, xend=end_date, y=fct_reorder(Location, start_date), yend=fct_reorder(Location, start_date)), color="grey") +
geom_point(aes(x=end_date, y=Location),
colour=rgb(0.9,0.3,0.1,0.9), size=3.5 ) +
geom_point(aes(x=start_date, y=Location),
colour=rgb(1.0,0.6,0.1,0.7), size=3) +
scale_x_continuous(breaks =
c(1993:2000))+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "none",
axis.text.x = element_text(angle=90, hjust=1),
axis.ticks.length.x= unit(0.1, "cm"),
panel.grid.minor.x = element_blank(),
panel.spacing.x = unit(1,"lines")
) +
xlab("Years") +
ylab("Location")+
labs(title=paste("Ocupation of Locations in", sfdf2()$Mission),
caption="Data from GeoPKO 2.0")
sfdf2 <- Years %>% filter(Mission=="UNOCI")
lolli <-   ggplot(sfdf2) +
geom_segment(aes(x=start_date, xend=end_date, y=fct_reorder(Location, start_date), yend=fct_reorder(Location, start_date)), color="grey") +
geom_point(aes(x=end_date, y=Location),
colour=rgb(0.9,0.3,0.1,0.9), size=3.5 ) +
geom_point(aes(x=start_date, y=Location),
colour=rgb(1.0,0.6,0.1,0.7), size=3) +
scale_x_continuous(breaks =
c(1993:2000))+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "none",
axis.text.x = element_text(angle=90, hjust=1),
axis.ticks.length.x= unit(0.1, "cm"),
panel.grid.minor.x = element_blank(),
panel.spacing.x = unit(1,"lines")
) +
xlab("Years") +
ylab("Location")+
labs(title=paste("Ocupation of Locations in", sfdf2()$Mission),
caption="Data from GeoPKO 2.0")
lolli
sfdf2 <- Years %>% filter(Mission=="UNOCI")
lolli <-   ggplot(sfdf2) +
geom_segment(aes(x=start_date, xend=end_date, y=fct_reorder(Location, start_date), yend=fct_reorder(Location, start_date)), color="grey") +
geom_point(aes(x=end_date, y=Location),
colour=rgb(0.9,0.3,0.1,0.9), size=3.5 ) +
geom_point(aes(x=start_date, y=Location),
colour=rgb(1.0,0.6,0.1,0.7), size=3) +
scale_x_continuous(breaks =
c(1993:2000))+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "none",
axis.text.x = element_text(angle=90, hjust=1),
axis.ticks.length.x= unit(0.1, "cm"),
panel.grid.minor.x = element_blank(),
panel.spacing.x = unit(1,"lines")
) +
xlab("Years") +
ylab("Location")+
labs(title=paste("Ocupation of Locations in", sfdf2()$Mission),
caption="Data from GeoPKO 2.0")
lolli <-   ggplot(sfdf2) +
geom_segment(aes(x=start_date, xend=end_date, y=fct_reorder(Location, start_date), yend=fct_reorder(Location, start_date)), color="grey") +
geom_point(aes(x=end_date, y=Location),
colour=rgb(0.9,0.3,0.1,0.9), size=3.5 ) +
geom_point(aes(x=start_date, y=Location),
colour=rgb(1.0,0.6,0.1,0.7), size=3) +
scale_x_continuous(breaks =
c(1993:2000))+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "none",
axis.text.x = element_text(angle=90, hjust=1),
axis.ticks.length.x= unit(0.1, "cm"),
panel.grid.minor.x = element_blank(),
panel.spacing.x = unit(1,"lines")
) +
xlab("Years") +
ylab("Location")+
labs(title=paste("Ocupation of Locations in", sfdf2$Mission),
caption="Data from GeoPKO 2.0")
lolli
lolli <-   ggplot(sfdf2) +
geom_segment(aes(x=start_date, xend=end_date, y=fct_reorder(Location, start_date), yend=fct_reorder(Location, start_date)), color="grey") +
geom_point(aes(x=end_date, y=Location),
colour=rgb(0.9,0.3,0.1,0.9), size=3.5 ) +
geom_point(aes(x=start_date, y=Location),
colour=rgb(1.0,0.6,0.1,0.7), size=3) +
scale_x_discrete(breaks =
c(1993:2000))+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "none",
axis.text.x = element_text(angle=90, hjust=1),
axis.ticks.length.x= unit(0.1, "cm"),
panel.grid.minor.x = element_blank(),
panel.spacing.x = unit(1,"lines")
) +
xlab("Years") +
ylab("Location")+
labs(title=paste("Ocupation of Locations in", sfdf2$Mission),
caption="Data from GeoPKO 2.0")
lolli
lolli <-   ggplot(sfdf2) +
geom_segment(aes(x=start_date, xend=end_date, y=fct_reorder(Location, start_date), yend=fct_reorder(Location, start_date)), color="grey") +
geom_point(aes(x=end_date, y=Location),
colour=rgb(0.9,0.3,0.1,0.9), size=3.5 ) +
geom_point(aes(x=start_date, y=Location),
colour=rgb(1.0,0.6,0.1,0.7), size=3) +
scale_x_discrete(breaks =
c(1993:2000))+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "none",
axis.text.x = element_text(angle=90, hjust=1),
axis.ticks.length.x= unit(0.1, "cm"),
panel.grid.minor.x = element_blank(),
panel.spacing.x = unit(1,"lines")
) +
xlab("Years") +
ylab("Location")+
labs(title=paste("Occupation of Locations in", sfdf2$Mission),
caption="Data from GeoPKO 2.0")
ggsave("lolli.png", plot=lolli)
runApp()
runApp()
install.packages("plotly")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
View(sfdf2)
sfdf2 <- Years %>% filter(Mission=="MINUGUA")
View(sfdf2)
View(sfdf2)
View(sfdf2)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
lolli <-   ggplot(sfdf2) +
geom_segment(aes(x=start_date, xend=end_date, y=fct_reorder(Location, start_date), yend=fct_reorder(Location, start_date)), color="grey") +
geom_point(aes(x=as.numeric(end_date), y=Location),
colour=rgb(0.9,0.3,0.1,0.9), size=3.5 ) +
geom_point(aes(x=as.numeric(start_date), y=Location),
colour=rgb(1.0,0.6,0.1,0.7), size=3) +
scale_x_continuous(breaks =
c(1993:2000))+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "none",
axis.text.x = element_text(angle=90, hjust=1),
axis.ticks.length.x= unit(0.1, "cm"),
panel.grid.minor.x = element_blank(),
panel.spacing.x = unit(1,"lines")
) +
xlab("Years") +
ylab("Location")+
labs(title=paste("Occupation of Locations in", sfdf2$Mission),
caption="Data from GeoPKO 2.0")
lolli
sfdf2 <- Years %>% filter(Mission=="MINUGUA") %>%
mutate_at(vars(c(start_date, end_date)), as.numeric)
lolli <-   ggplot(sfdf2) +
geom_segment(aes(x=start_date, xend=end_date, y=fct_reorder(Location, start_date), yend=fct_reorder(Location, start_date)), color="grey") +
geom_point(aes(x=as.numeric(end_date), y=Location),
colour=rgb(0.9,0.3,0.1,0.9), size=3.5 ) +
geom_point(aes(x=as.numeric(start_date), y=Location),
colour=rgb(1.0,0.6,0.1,0.7), size=3) +
scale_x_continuous(breaks =
c(1993:2000))+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "none",
axis.text.x = element_text(angle=90, hjust=1),
axis.ticks.length.x= unit(0.1, "cm"),
panel.grid.minor.x = element_blank(),
panel.spacing.x = unit(1,"lines")
) +
xlab("Years") +
ylab("Location")+
labs(title=paste("Occupation of Locations in", sfdf2$Mission),
caption="Data from GeoPKO 2.0")
lolli
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp('ShinyTwotabs.R')
shiny::runApp()
runApp()
geopko <- geopko %>%
mutate_at(vars(c(No.troops, No.TCC, Longitude, Latitude,
UNMO.dummy, UNPOL.dummy)), as.numeric) %>%
mutate(vars(HQ), as_factor)
runApp()
geopko <- geopko %>%
mutate_at(vars(c(No.troops, No.TCC, Longitude, Latitude,
UNMO.dummy, UNPOL.dummy)), as.numeric) %>%
mutate(HQ=as.factor(HQ))
runApp()
library(shiny); runApp('ShinyTwotabs.R')
runApp('ShinyTwotabs.R')
library(dplyr)
names(geopko)
tcc_df <- geopko %>% select(Source:Location, Latitude, Longitude,
No.TCC:notroopspertcc_17)
tcc_df2 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_")
library(tidyr)
tcc_df2 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_")
View(tcc_df2)
tcc_df2 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc))
tcc_df2 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%  select(-TCC_id)
tcc_df2 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%  select(-TCC_id, -Month) %>%
group_by(Source:nameoftcc) %>%
summarise(count.per.tcc.year=sum(notroopspertcc, na.rm=TRUE))
tcc_df2 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC) %>%
summarise(count.per.tcc.year=sum(notroopspertcc, na.rm=TRUE))
tcc_df2 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC) %>%
summarise(count.per.tcc.year=sum(notroopspertcc, na.rm=TRUE))
tcc_df <- geopko %>% select(Source:Location, Latitude, Longitude,
No.TCC:notroopspertcc_17)
tcc_df2 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC, nameoftcc) %>%
summarise(count.per.tcc.year=sum(notroopspertcc, na.rm=TRUE))
tcc_df2 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC, nameoftcc) %>%
summarise(count.per.tcc.year=sum(notroopspertcc, na.rm=TRUE)) %>%
mutate(single.tcc=paste0(nameofTCC, " (",count.per.tcc.year,(")"))) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude) %>%
summarise(year.overview = str_c(single.tcc))
tcc_df2 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC, nameoftcc) %>%
summarise(count.per.tcc.year=sum(notroopspertcc, na.rm=TRUE)) %>%
mutate(single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")"))) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude) %>%
summarise(year.overview = str_c(single.tcc))
library(stringr)
tcc_df <- geopko %>% select(Source:Location, Latitude, Longitude,
No.TCC:notroopspertcc_17)
tcc_df2 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC, nameoftcc) %>%
summarise(count.per.tcc.year=sum(notroopspertcc, na.rm=TRUE)) %>%
mutate(single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")"))) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude) %>%
summarise(year.overview = str_c(single.tcc))
tcc_df2 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC, nameoftcc) %>%
summarise(count.per.tcc.year=sum(notroopspertcc, na.rm=TRUE)) %>%
mutate(single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")"))) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC) %>%
summarise(year.overview = str_c(single.tcc))
tcc_df2 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC, nameoftcc) %>%
summarise(count.per.tcc.year=sum(notroopspertcc, na.rm=TRUE)) %>%
mutate(single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")"))) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC) %>%
summarise(year.overview = str_c(single.tcc, collapse=", "))
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric)
View(tcc_df3)
summarise(count.per.tcc.year=max(notroopspertcc) %>%
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC, nameoftcc) %>%
summarise(count.per.tcc.year=max(notroopspertcc))
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC, nameoftcc) %>%
summarise(count.per.tcc.year=max(notroopspertcc))
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC, nameoftcc) %>%
summarise(count.per.tcc.year=max(notroopspertcc))
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC, nameoftcc) %>%
summarise(count.per.tcc.year=max(notroopspertcc)) %>%
mutate(count.per.tcc.year=ifelse(is.na(count.per.tcc.year), "unknown", as.numeric(count.per.tcc.year)),
single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")"))) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC) %>%
summarise(year.overview = str_c(single.tcc, collapse=", "))
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC, nameoftcc) %>%
summarise(count.per.tcc.year=as.character(max(notroopspertcc))) %>%
mutate(count.per.tcc.year=ifelse(is.na(count.per.tcc.year), "unknown", count.per.tcc.year),
single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")"))) %>%
group_by(Source, Mission, Year, Location, Latitude, Longitude, No.TCC) %>%
summarise(year.overview = str_c(single.tcc, collapse=", "))
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Mission, Year, Location, Latitude, Longitude, No.TCC, nameoftcc) %>%
summarise(count.per.tcc.year=as.character(max(notroopspertcc))) %>%
mutate(count.per.tcc.year=ifelse(is.na(count.per.tcc.year), "unknown", count.per.tcc.year),
single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")"))) %>%
group_by(Mission, Year, Location, Latitude, Longitude, No.TCC) %>%
summarise(year.overview = str_c(single.tcc, collapse=", "))
write.csv(tcc_df3, "tcc_dataframe.csv")
tcc_df3 %>% filter(Mission=="UNOCI") %>% arrange(Year, Location)
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Mission, Year, Location, Latitude, Longitude, No.TCC, nameoftcc) %>%
arrange(desc(No.TCC)) %>%
slice(1) %>%
summarise(count.per.tcc.year=as.character(max(notroopspertcc))) %>%
mutate(count.per.tcc.year=ifelse(is.na(count.per.tcc.year), "unknown", count.per.tcc.year),
single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")"))) %>%
group_by(Mission, Year, Location, Latitude, Longitude, No.TCC) %>%
summarise(year.overview = str_c(single.tcc, collapse=", "))
tcc_df3 %>% filter(Mission=="UNOCI") %>% arrange(Year, Location)
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Mission, Year, Location, Latitude, Longitude, nameoftcc) %>%
summarise(count.per.tcc.year=as.character(max(notroopspertcc))) %>%
mutate(count.per.tcc.year=ifelse(is.na(count.per.tcc.year), "unknown", count.per.tcc.year),
single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")"))) %>%
group_by(Mission, Year, Location, Latitude, Longitude) %>%
summarise(year.overview = str_c(single.tcc, collapse=", "))
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Mission, Year, Location, Latitude, Longitude, nameoftcc) %>%
summarise(count.per.tcc.year=as.character(max(notroopspertcc)))
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Mission, Year, Location, Latitude, Longitude, nameoftcc) %>%
summarise(count.per.tcc.year=as.character(max(notroopspertcc))) %>%
count(Mission, Year, Location, Latitude, Longitude) %>%
mutate(count.per.tcc.year=ifelse(is.na(count.per.tcc.year), "unknown", count.per.tcc.year),
single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")"))) %>%
group_by(Mission, Year, Location, Latitude, Longitude) %>%
summarise(year.overview = str_c(single.tcc, collapse=", "))
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Mission, Year, Location, Latitude, Longitude, nameoftcc) %>%
summarise(count.per.tcc.year=as.character(max(notroopspertcc))) %>%
mutate(count.per.tcc.year=ifelse(is.na(count.per.tcc.year), "unknown", count.per.tcc.year),
single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")"))) %>%
add_count(Mission, Year, Location, Latitude, Longitude) %>%
group_by(Mission, Year, Location, Latitude, Longitude) %>%
summarise(year.overview = str_c(single.tcc, collapse=", "))
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Mission, Year, Location, Latitude, Longitude, nameoftcc) %>%
summarise(count.per.tcc.year=as.character(max(notroopspertcc))) %>%
mutate(count.per.tcc.year=ifelse(is.na(count.per.tcc.year), "unknown", count.per.tcc.year),
single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")"))) %>%
group_by(Mission, Year, Location, Latitude, Longitude) %>%
summarise(year.overview = str_c(single.tcc, collapse=", "))
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Mission, Year, Location, Latitude, Longitude, nameoftcc) %>%
summarise(count.per.tcc.year=as.character(max(notroopspertcc))) %>%
mutate(count.per.tcc.year=ifelse(is.na(count.per.tcc.year), "unknown", count.per.tcc.year),
single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")")))
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Mission, Year, Location, Latitude, Longitude, nameoftcc) %>%
summarise(count.per.tcc.year=as.character(max(notroopspertcc))) %>%
mutate(count.per.tcc.year=ifelse(is.na(count.per.tcc.year), "unknown", count.per.tcc.year),
single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")"))) %>%
add_count(Year, Location)
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Mission, Year, Location, Latitude, Longitude, nameoftcc) %>%
summarise(count.per.tcc.year=as.character(max(notroopspertcc))) %>%
mutate(count.per.tcc.year=ifelse(is.na(count.per.tcc.year), "unknown", count.per.tcc.year),
single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")"))) %>%
add_count(Year, Location, name=No.TCC)%>%
group_by(Mission, Year, Location, Latitude, Longitude, No.TCC) %>%
summarise(year.overview = str_c(single.tcc, collapse=", "))
tcc_df3 <- tcc_df %>% pivot_longer(nameoftcc_1:notroopspertcc_17,
names_to=c(".value", "TCC_id"),
names_sep="_") %>%
filter(!is.na(nameoftcc)) %>%
mutate_at(vars(notroopspertcc), as.numeric) %>%
group_by(Mission, Year, Location, Latitude, Longitude, nameoftcc) %>%
summarise(count.per.tcc.year=as.character(max(notroopspertcc))) %>%
mutate(count.per.tcc.year=ifelse(is.na(count.per.tcc.year), "unknown", count.per.tcc.year),
single.tcc=paste0(nameoftcc, " (",count.per.tcc.year,(")"))) %>%
add_count(Year, Location, name="No.TCC")%>%
group_by(Mission, Year, Location, Latitude, Longitude, No.TCC) %>%
summarise(year.overview = str_c(single.tcc, collapse=", "))
write.csv(tcc_df3, "tcc_dataframe.csv")
geopko %>% filter(Location=="UNPA")
duplicated(tcc_df3, by=c("Year", "Location"))
anyDuplicated(tcc_df3, by=c("Year", "Location"))
uniqueN(tcc_df3, by=c("Year", "Location"))
